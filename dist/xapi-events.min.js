!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.xapiEvents=t()}}(function(){return function t(e,n,s){function i(a,r){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!r&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var v=n[a]={exports:{}};e[a][0].call(v.exports,function(t){var n=e[a][1][t];return i(n?n:t)},v,v.exports,t,e,n,s)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<s.length;a++)i(s[a]);return i}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.xAPIEventsConfig={debug:!1}},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.EventStatus=Object.freeze({ON:"ON",OFF:"OFF",DISABLED:"DISABLED"})},{}],3:[function(t,e,n){"use strict";function s(t){return this.log("validateEvent",{xapiEvent:t}),this.errors=[],i.call(this,t),o.call(this,t),a.call(this,t),r.call(this,t),u.call(this,t),this.errors.length?this.log(g,{event:t,errors:this.errors}):this.log(m),this}function i(t){return this.log("_mustHaveId",{xapiEvent:t}),!!t.id||(this.errors.push(d),!1)}function o(t){return this.log("_mustHaveUniqueId",{xapiEvent:t}),!this.events.length||!this.events.filter(function(t){return t.id===t.id}).length||(this.errors.push(f),!1)}function a(t){return this.log("_mustHaveName",{xapiEvent:t}),!!t.name||(this.errors.push(d),!1)}function r(t){return this.log("_mustHaveStatus",{xapiEvent:t}),!(!t.status||!l.call(this,t))||(this.errors.push(E),!1)}function l(t){return this.log("isValidStatus",{xapiEvent:t}),t.status===v.EventStatus.ON||t.status===v.EventStatus.OFF||t.status===v.EventStatus.DISABLED}function u(t){return this.log("_mustHaveCallbackFunction",{xapiEvent:t}),!(!t&&Object.prototype.toString.call(t.callback)!==c)||(this.errors.push(h),!1)}Object.defineProperty(n,"__esModule",{value:!0}),n.xapiEventValidator=void 0;var v=t("./event-status"),c="[object Function]",d="Must have an id",f="Must have a unique id",E="Must have a status",h="Must have a correct callback function",g="Not valid event:",m="Valid event";n.xapiEventValidator={isValidEvent:function(t){return this.log("isValidEvent",{e:t}),!s.call(this,t).errors.length}}},{"./event-status":2}],4:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.xapiEvent=void 0;var s=t("./event-status");n.xapiEvent={id:void 0,callback:void 0,name:void 0,elementSelectors:[],targetElements:[],statement:void 0,status:s.EventStatus.DISABLED,isValid:!1}},{"./event-status":2}],5:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.xapiHelpers={getSelection:function(){return window.getSelection().toString()}}},{}],6:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.xAPIEventStatementContext={registration:void 0,instructor:void 0,team:void 0,contextActivities:void 0,revision:void 0,platform:void 0,language:void 0,statement:void 0,extensions:void 0}},{}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.xAPIEventStatement={actor:void 0,verb:void 0,object:void 0,result:void 0,context:void 0,timestamp:void 0,stored:void 0,authority:void 0,version:void 0,attachments:void 0}},{}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.logger=void 0;var s=t("../config");n.logger={debug:s.xAPIEventsConfig.debug,log:function(){if(!s.xAPIEventsConfig.debug)return!1;try{var t;return(t=console).log.apply(t,arguments),!0}catch(t){return!1}}}},{"../config":1}],9:[function(t,e,n){"use strict";function s(t,e){var n=void 0;return this.log("_buildBaseStatement",{actor:t,authority:e}),n=o.call(this,t),Object.assign(this.baseStatement,l.xAPIEventStatement,{actor:t,context:n,authority:e})}function i(){var t=void 0;return this.log("_buildBaseStatementConfig"),t=this.baseStatement,{baseStatement:t,platform:navigator?navigator.userAgent:null,language:navigator?navigator.language:null}}function o(t){var e=void 0;return this.log("_getStatementConfigStructure",{actor:t}),e=t||null,Object.assign(u.xAPIEventStatementContext,{instructor:e})}function a(t){return this.log("_isEnabled",t.status),t.status===v.EventStatus.ON}Object.defineProperty(n,"__esModule",{value:!0}),n.isValidEvent=n.disableElementsByElementId=n.disableEventById=n.disableAllEvents=n.disableEvent=n.enableElementsByElementId=n.enableEventById=n.enableAllEvents=n.enableEvent=n.removeEventsByElementId=n.removeEventById=n.addEvents=n.addEvent=n.stopEnabledEvents=n.listenEnabledEvents=n.setStatementConfigInfo=n.setBaseStatement=n.getTargetElements=n.reset=n.init=n.helpers=n.LRS=n.targetElements=n.errors=n.events=n.baseStatement=n.log=void 0;var r=t("./utils/logger"),l=t("./statements/structure"),u=t("./statements/context"),v=t("./events/event-status"),c=t("./events/xapi-event-validator"),d=t("./events/xapi-event"),f=t("./events/xapi-helpers");n.log=r.logger.log,n.baseStatement={},n.events=[],n.errors=[],n.targetElements=[],n.LRS={},n.helpers=f.xapiHelpers,n.init=function(t,e){return this.log("init"),this.setBaseStatement(t,e)},n.reset=function(){return this.log("reset"),this.setBaseStatement(this.baseStatement.author,this.baseStatement.authority)},n.getTargetElements=function(){var t=this;this.log("getTargetElements"),this.events.forEach(function(e){e.elementSelectors.forEach(function(e){t.log("elementSelector",e);var n=document.querySelectorAll(e);n.length&&n.forEach(function(e){t.log("elements",e),t.targetElements.push(e)})})})},n.setBaseStatement=function(t,e){return this.log("setBaseStatement"),!(!t||!e)&&s.call(this,t,e)},n.setStatementConfigInfo=function(){return this.log("setStatementConfigInfo"),!!this.baseStatement&&i.call(this)},n.listenEnabledEvents=function(){var t=this;this.log("listenEnabledEvents"),this.events.forEach(function(e){if(t.log("xapiEvent",e),a.call(t,e)){var n=document.querySelectorAll(e.elementSelectors);n.forEach(function(n){n&&(t.log("targetElement",n),n.addEventListener(e.name,function(n){e.callback.call(t,n,e)},!1))})}})},n.stopEnabledEvents=function(){var t=this;this.log("stopEnabledEvents"),this.events.forEach(function(e){a.call(t,e)&&t.targetElements.forEach(function(t){t.removeEventListener(e.name)})})},n.addEvent=function(t){if(this.log("addEvent",{eventObj:t}),this.isValidEvent(t)){var e=Object.assign({},d.xapiEvent,t);return this.events.push(e),!0}return!1},n.addEvents=function(t){var e=this;this.log("addEvents",{events:t}),t.forEach(function(t){e.addEvent(t)}),this.getTargetElements()},n.removeEventById=function(t){this.log("removeEventById",{eventId:t}),this.events=this.events.filter(function(e){return e.id!==t})},n.removeEventsByElementId=function(t){this.log("removeEventsByElementId",{elementId:t}),this.events=this.events.filter(function(e){return e.elementId!==t})},n.enableEvent=function(t){this.log("enableEvent",{_event:t}),this.events.forEach(function(e){if(t.id===e.id)return void(e.status=v.EventStatus.ON)})},n.enableAllEvents=function(){this.log("enableAllEvents"),this.events.forEach(function(t){t.status=v.EventStatus.ON})},n.enableEventById=function(t){this.log("enableEventById"),this.events.forEach(function(e){if(t===e.id)return void(e.status=v.EventStatus.ON)})},n.enableElementsByElementId=function(t){this.log("enableElementsByElementId",{elementId:t}),this.events.forEach(function(e){t===e.elementId&&(e.status=v.EventStatus.ON)})},n.disableEvent=function(t){this.log("disableEvent",{_event:t}),this.events.forEach(function(e){if(t.id===e.id)return void(e.status=v.EventStatus.OFF)})},n.disableAllEvents=function(){this.log("disableAllEvents"),this.events.forEach(function(t){t.status=v.EventStatus.OFF})},n.disableEventById=function(t){this.log("disableEventById",{eventId:t}),this.events.forEach(function(e){if(t===e.id)return void(e.status=v.EventStatus.OFF)})},n.disableElementsByElementId=function(t){this.log("disableElementsByElementId",{elementId:t}),this.events.forEach(function(e){t===e.elementId&&(e.status=v.EventStatus.OFF)})},n.isValidEvent=function(t){return this.log("isValidEvent",{_event:t}),c.xapiEventValidator.isValidEvent.call(this,t)}},{"./events/event-status":2,"./events/xapi-event":4,"./events/xapi-event-validator":3,"./events/xapi-helpers":5,"./statements/context":6,"./statements/structure":7,"./utils/logger":8}]},{},[9])(9)});
//# sourceMappingURL=maps/xapi-events.min.js.map
